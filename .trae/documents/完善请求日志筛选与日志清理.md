## 关键点
- 已确认请求的上下文信息写入 `logs.context`（JSON），包含 `method/path/query/ip/user_agent/status/duration_ms/trace_id/user_id`。
- 方案将直接基于 `context` 的 JSON 字段做服务端精确过滤，无需解析 `message` 字符串。

## 前端改造（/logs/requests）
- 新增路由与页面：`apps/frontend/src/routes/_authenticated/logs/requests.tsx`
  - 使用 `zod` 校验 `page/pageSize/keyword/url/method/status`。
  - 页面结构复用现有 `SystemLogs` 模式：读取搜索参数，组装 `apiParams`，通过查询 Hook 获取数据。
- API 封装与 Hook：
  - 新增 `apps/frontend/src/features/system/logs/api/request-logs-api.ts`，统一用 `apiClient` 调用 `/api/logs`，追加 `url/method/status` 参数；导出同理。
  - 新增 `apps/frontend/src/features/system/logs/hooks/use-request-logs-query.ts`（`react-query`）。
- 表格与筛选：新增 `apps/frontend/src/features/system/logs/components/request-logs-table.tsx`
  - 列：`timestamp/method/url/status/ip_address/user_agent/log_source/id`（优先使用后端返回字段；若未返回则从 `action` 兜底解析）。
  - 过滤 UI：复用 `DataTableToolbar`，新增 Faceted 过滤：
    - `method`: `GET,POST,PUT,DELETE,PATCH`
    - `status`: 常用码或分段（与后端参数一致）
    - `url`: 文本输入（映射 `searchKey=url`）
  - `useTableUrlState` 中新增映射：`url/method/status` → 对应搜索 Key。

## 后端改造（基于 JSON 字段过滤）
- 模型参数：更新 `apps/server/src/logs/models.rs` 的 `LogListQuery`，新增：
  - `method: Option<String>`、`status: Option<i32>`、`url: Option<String>`。
- 列表接口：`apps/server/src/logs/handlers.rs:get_logs`
  - `method` 过滤：`context->>'method' = $1`。
  - `status` 过滤：`(context->>'status')::int = $1`。
  - `url` 过滤：`context->>'path' ILIKE '%' || $1 || '%'`（支持模糊）。
  - 其余已有过滤保持不变；排序按 `timestamp DESC`。
- 导出接口：`export_logs` 同步支持上述 `url/method/status` 过滤。
- 响应增强（可选）：在 `LogResponse` 增加 `method/path/status` 字段，便于前端直接显示；不影响现有使用。

## 定时任务：日志清理（30 天）
- 在 `apps/server/src/maintenance/data_cleaner.rs`：
  - 新增 `run_logs_cleanup(db)`：`logs::Entity::delete_many().filter(logs::Column::CreatedAt.lt(Utc::now() - Duration::days(30)))`，记录 `rows_affected` 与耗时。
  - 在每日任务循环中调用 `run_data_cleanup` 后追加 `run_logs_cleanup`；或新增 `start_logs_cleaner(db)` 并在 `apps/server/src/maintenance/scheduler.rs` 注册。

## 验证
- 后端：在 `apps/server` 执行 `cargo check` / `cargo build`，确保新增过滤与清理编译通过。
- 前端：访问 `/logs/requests` 验证翻页、关键字与 `url/method/status` 服务端筛选生效；导出链接包含新参数。

## 参考文件
- 中间件写入：`apps/server/src/logs/middleware.rs:56-129,131-144`
- 实体定义：`apps/server/src/entities/logs.rs:5-18`
- 查询与导出：`apps/server/src/logs/handlers.rs:8-112,114-189`
- 现有前端系统日志：`apps/frontend/src/routes/_authenticated/logs/system.tsx:5-18`、`features/system/logs/index.tsx:16-29`、`components/system-logs-table.tsx:34-43,50-57`
- 定时任务：`apps/server/src/maintenance/scheduler.rs:7-16`、`apps/server/src/maintenance/data_cleaner.rs:8-31,35-57`

## 交付
- 按以上方案提供最小改动补丁，严格使用 `apiClient` 与前端代理，UI 保持 shadcn 风格；确认后开始实现与自检。